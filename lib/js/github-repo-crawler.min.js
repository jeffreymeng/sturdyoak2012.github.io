/* Copyright (c) 2018 Jeffrey Meng | 1.1.2 | MIT License */
!function(t){"use strict";t.GitHubRepoCrawler=function(){function t(t){return t&&"[object Function]"==={}.toString.call(t)}function e(e){var n=new XMLHttpRequest;n.open("GET",e.url+(e.url.indexOf("?")>-1?"":"?")+function(t){if(null==t)return"";var e=[];for(var n in t)t.hasOwnProperty(n)&&null!=t[n]&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}(e.parameters),!0),n.setRequestHeader("Content-Type",e.contentType),n.onload=function(){if(n.status>=200&&n.status<400){var s=n.responseText;t(e.success)&&e.success(s)}else s=n.responseText,t(e.error)&&e.error(s);t(e.always)&&e.always(s)},n.onerror=function(){var t=n.responseText;e.error(t)},n.send()}var n=function(t,s,i){if(!(this instanceof n))return new n(url,i);i?(i.name=s,i.owner=t):s?(i="string"==typeof s?{name:s}:s).owner=t:i=t,this.TYPE="type",this.EXTENSION="extension",this.PATH="path",this._listeners={},this._listeners[this.TYPE]={},this._listeners[this.EXTENSION]={},this._listeners[this.PATH]={},this.on=function(t,e,n){for(var s=e.split(" "),i=0;i<s.length;i++)null==this._listeners[t]?this._listeners[t]={}:null==this._listeners[t][s[i]]?this._listeners[t][s[i]]=new Array(1).fill(n):this._listeners[t][s[i]].push(n)},this.onType=function(t,e){this.on(this.TYPE,t,e)},this.onExtension=function(t,e){this.on(this.EXTENSION,t,e)},this.onName=function(t,e){this.on(this.NAME,t,e)},this.off=function(t,e,n){for(var s=e.split(" "),i=0;i<s.length;i++)if(null!=this._listeners[t]&&null!=this._listeners[t][s[i]])for(var r=0;r<this._listeners[t][s[i]].length;r++)this._listeners[t][s[i]][r]==n&&this._listeners[t][s[i]].splice(r,1)},this.offType=function(t,e){this.off(this.TYPE,t,e)},this.offExtension=function(t,e){this.off(this.EXTENSION,t,e)},this.offName=function(t,e){this.off(this.NAME,t,e)},this.crawl=function(n){var r=this;!function t(o,l){var h=!1;e({url:l,contentType:"application/vnd.github.v3+json",parameters:{ref:i.ref},success:function(e){var i,l,a,f,u,p,c,_,T=JSON.parse(e);for(i=0;i<T.length;i++){if(a=(p=T[i]).type,s=p.name,u=p.path,f=s.split(".")[s.split(".").length-1],_={name:s,path:p.path,type:a,extension:f,depth:o,githubURL:p.html_url,rawURL:p.download_url,githubData:p},c={enterDirectory:!0,stopCrawl:!1},r._listeners.type[a])for(l=0;l<r._listeners.type[a].length;l++)c=r._listeners.type[a][l](_)||c;if(r._listeners.extension[f])for(l=0;l<r._listeners.extension[f].length;l++)c=r._listeners.extension[f][l](_)||c;if(r._listeners.path[u])for(l=0;l<r._listeners.path[u].length;l++)c=r._listeners.path[u][l](_)||c;if(c.stopCrawl)break;"dir"==a&&c.enterDirectory&&(h=!0,t(o+1,p.url))}h||n()},error:function(t){throw JSON.parse(t),new Error("GitRepoCrawler: GET Request failed.")}})}(0,`https://api.github.com/repos/${t}/${s}/contents`)}};return n}()}(window);